title: AWS CloudTrail bypass for specific IAM actions
slug: aws-iamadmin-cloudtrail-bypass
cves: null
affectedPlatforms:
- AWS
affectedServices:
- IAM
image: <fill in>
severity: Low
discoveredBy:
  name: Nick Frichette
  org: Datadog
  domain: https://securitylabs.datadoghq.com/
  twitter: frichette_n
publishedAt: 2023/01/17
disclosedAt: 2022/03/10
exploitabilityPeriod: Until 2022/10/24
knownITWExploitation: false
summary: |
  Through the undocumented API service iamadmin, attackers could invoke the following IAM actions without logging to CloudTrail. 
  This enabled adversaries to perform enumeration/reconnaissance activity undetected after gaining a foothold in a victim AWS environment. 

  iam:ListGroupPolicies
  iam:ListAttachedGroupPolicies
  iam:GetGroup
  iam:ListGroupsForUser
  iam:ListAccessKeys
  iam:GetAccessKeyLastUsed
  iam:GetLoginProfile
  iam:ListPolicies
  iam:GetRole
  iam:ListMFADevices
  iam:ListSigningCertificates
  iam:GetServiceLinkedRoleDeletionStatus
  iam:GetServiceLinkedRoleTemplate
manualRemediation: |
  None required 
detectionMethods: N/A
contributor: https://github.com/frichetten
references:
- https://securitylabs.datadoghq.com/articles/iamadmin-cloudtrail-bypass/
